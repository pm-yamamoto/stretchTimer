# タスク管理

## プロジェクト進行状況

### 📊 概要
- **プロジェクト**: ストレッチタイマーPWA
- **開始日**: 2024-10-24
- **現在のフェーズ**: 要件定義・設計完了
- **次のフェーズ**: 実装開始

## 🎯 マイルストーン

### Phase 1: 設計・準備 ✅
- [x] 要件定義書作成
- [x] 技術仕様書作成
- [x] プロジェクト文書整備
- [x] ディレクトリ構成設計

### Phase 2: 基盤実装 🔄
- [ ] プロジェクト基盤構築
- [ ] PWA基本設定
- [ ] UI基盤実装
- [ ] 状態管理システム構築

### Phase 3: コア機能実装 ⏳
- [ ] タイマー機能実装
- [ ] デバイス向き検出実装
- [ ] ストレッチ完了システム実装
- [ ] 設定管理機能実装

### Phase 4: PWA機能実装 ⏳
- [ ] Service Worker実装
- [ ] Manifest設定
- [ ] オフライン対応
- [ ] インストール機能

### Phase 5: 通知・UX実装 ⏳
- [ ] 通知システム実装
- [ ] ダークモード実装
- [ ] レスポンシブ対応
- [ ] アクセシビリティ対応

### Phase 6: テスト・最適化 ⏳
- [ ] 機能テスト実装
- [ ] パフォーマンス最適化
- [ ] クロスブラウザテスト
- [ ] デバイステスト

## 📋 詳細タスクリスト

### 🏗️ Phase 2: 基盤実装

#### 2.1 プロジェクト基盤構築
- [ ] **htdocs/ディレクトリ作成**
  - [ ] 基本ディレクトリ構成作成
  - [ ] css/, js/, icons/ ディレクトリ作成
- [ ] **index.html作成**
  - [ ] 基本HTML構造
  - [ ] メタタグ設定
  - [ ] PWAマニフェスト参照
- [ ] **基本CSS設定**
  - [ ] style.css作成
  - [ ] CSS Variables設定
  - [ ] リセットCSS適用

#### 2.2 PWA基本設定  
- [ ] **manifest.json作成**
  - [ ] PWA設定項目記述
  - [ ] アイコン設定
  - [ ] 表示モード設定
- [ ] **アイコン作成**
  - [ ] 192x192pxアイコン
  - [ ] 512x512pxアイコン
  - [ ] favicon.ico
- [ ] **Service Worker基本設定**
  - [ ] sw.js作成
  - [ ] 基本キャッシュ戦略実装

#### 2.3 UI基盤実装
- [ ] **レイアウトシステム構築**
  - [ ] フレックスボックス/グリッド設定
  - [ ] レスポンシブブレイクポイント
- [ ] **コンポーネント基盤**
  - [ ] ボタンスタイル
  - [ ] カードレイアウト
  - [ ] モーダルシステム
- [ ] **ダークモード基盤**
  - [ ] CSS Variables for テーマ
  - [ ] テーマ切り替え機能

### ⚙️ Phase 3: コア機能実装

#### 3.1 タイマー機能実装
- [ ] **TimerManagerクラス作成**
  - [ ] タイマー開始/停止機能
  - [ ] 一時停止/再開機能  
  - [ ] 残り時間計算
  - [ ] バックグラウンド実行対応
- [ ] **タイマーUI実装**
  - [ ] 円形プログレスバー
  - [ ] 残り時間表示
  - [ ] 制御ボタン
- [ ] **タイマー設定機能**
  - [ ] 間隔設定スライダー
  - [ ] プリセット間隔ボタン
  - [ ] 設定保存機能

#### 3.2 デバイス向き検出実装  
- [ ] **OrientationManagerクラス作成**
  - [ ] DeviceOrientationAPI実装
  - [ ] iOS権限要求対応
  - [ ] 立位判定ロジック（beta/gammaで縦持ち判定）
  - [ ] 方向判定ロジック（alphaでコンパス方位判定）
  - [ ] 閾値設定機能（立位±30°、方向±30°）
  - [ ] 方位角から方角名変換機能
- [ ] **向き検出UI実装**
  - [ ] 立位検知ステータス表示（緑チェック/グレードット）
  - [ ] 方向検知ステータス表示（緑チェック/オレンジ点）
  - [ ] 現在方向表示（例：「方向不一致 (東)」）
  - [ ] リアルタイム更新

#### 3.3 ストレッチ完了システム実装
- [ ] **完了条件管理**
  - [ ] 二条件同時満足判定ロジック（立位 AND 方向一致）
  - [ ] タイマー完了後の条件チェック開始
  - [ ] 条件変更時のリアルタイムボタン状態更新
- [ ] **ストレッチ画面実装**
  - [ ] メインタイマー表示（HH:MM:SS形式）
  - [ ] 次回予定時刻表示
  - [ ] プログレスバー実装
  - [ ] 状態表示エリア（タイマー残り時間表示）
  - [ ] 立位検知ステータス表示
  - [ ] 方向検知ステータス表示
  - [ ] 「ストレッチ完了を記録」ボタン（条件制御）
- [ ] **完了後処理**
  - [ ] 履歴記録（日時、完了状態、所要時間）
  - [ ] 次回タイマー自動開始
  - [ ] 統計データ更新（完了数カウント）

#### 3.4 設定管理機能実装
- [x] **StorageManagerクラス作成**
  - [x] LocalStorage操作
  - [x] 設定データ管理
  - [x] 履歴データ管理
  - [x] 間隔バリデーション機能（3-240分）
- [x] **設定画面実装**
  - [x] 設定項目UI
  - [x] バリデーション
  - [x] リアルタイム保存
  - [x] 短時間プリセット追加（3, 5, 10, 15分）

### 📱 Phase 4: PWA機能実装

#### 4.1 Service Worker実装
- [ ] **キャッシュ戦略実装**
  - [ ] アプリシェルキャッシュ
  - [ ] 動的キャッシュ
  - [ ] キャッシュ更新戦略
- [ ] **オフライン対応**
  - [ ] オフライン検知
  - [ ] フォールバック処理
  - [ ] 同期機能

#### 4.2 インストール機能
- [ ] **インストールプロンプト**
  - [ ] beforeinstallprompt イベント
  - [ ] カスタムインストールUI
  - [ ] インストール後の処理
- [ ] **アプリ更新機能**
  - [ ] 新バージョン検知
  - [ ] 更新プロンプト
  - [ ] リロード処理

### 🔔 Phase 5: 通知・UX実装

#### 5.1 通知システム実装
- [ ] **NotificationManagerクラス作成**
  - [ ] 権限管理
  - [ ] 通知表示
  - [ ] バックグラウンド通知
- [ ] **通知設定UI**
  - [ ] 権限要求フロー
  - [ ] 通知設定項目
  - [ ] プレビュー機能

#### 5.2 UX改善実装
- [ ] **アニメーション実装**
  - [ ] 画面遷移アニメーション
  - [ ] プログレスアニメーション  
  - [ ] マイクロインタラクション
- [ ] **アクセシビリティ対応**
  - [ ] キーボードナビゲーション
  - [ ] スクリーンリーダー対応
  - [ ] カラーコントラスト調整

### 🧪 Phase 6: テスト・最適化

#### 6.1 テスト実装
- [ ] **機能テスト**
  - [ ] タイマー機能テスト
  - [ ] 向き検出テスト
  - [ ] 通知機能テスト
- [ ] **統合テスト**
  - [ ] PWA機能テスト
  - [ ] オフライン動作テスト
  - [ ] デバイステスト

#### 6.2 最適化
- [ ] **パフォーマンス最適化**
  - [ ] Lighthouse監査
  - [ ] 読み込み速度最適化
  - [ ] バンドルサイズ最適化
- [ ] **SEO・アクセシビリティ**
  - [ ] メタタグ最適化
  - [ ] ARIA属性追加
  - [ ] 構造化データ追加

## 🔄 進行管理

### 現在の優先タスク
1. **htdocs/基盤構築** - Phase 2.1
2. **基本UI実装** - Phase 2.3  
3. **タイマー機能実装** - Phase 3.1

### 次週の目標
- Phase 2完了（基盤実装）
- Phase 3.1開始（タイマー機能）

### 課題・リスク
- **DeviceOrientationAPI**: iOS権限要求の複雑さ
- **通知機能**: ブラウザ差異への対応
- **PWA**: Safari での制限事項対応

## 📈 進捗メトリクス

### 完了率
- **要件定義**: 100% ✅
- **設計**: 100% ✅
- **実装**: 0% ⏳
- **テスト**: 0% ⏳

### 工数見積もり
- **Phase 2**: 8時間
- **Phase 3**: 16時間
- **Phase 4**: 12時間
- **Phase 5**: 8時間
- **Phase 6**: 6時間
- **合計**: 50時間

## 📝 決定事項ログ

### 2024-10-24
- **技術スタック決定**: Vanilla JavaScript採用
- **PWA方針**: オフライン基本動作 + 通知機能重視
- **UI方針**: モバイルファースト + ダークモード対応
- **API選択**: DeviceOrientationAPI + Notification API

## 🎯 次のアクション

1. htdocs/ディレクトリ構成作成
2. index.html基本構造実装
3. manifest.json作成
4. 基本CSS設定
5. Service Worker基本実装